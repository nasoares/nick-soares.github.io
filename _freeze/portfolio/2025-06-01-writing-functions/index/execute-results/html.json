{
  "hash": "f26c01f37bbd80933e9a39374e64dd92",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Writing Functions\"\ndescription: \"Writing efficient functions and using purrr for iteration\"\nauthor: \n  - name: \"Nick Soares\"\n    url: https://github.com/nasoares\ndate: 06-01-2025\nimage: purrr_logo.jpg\n---\n\n::: {.cell context='setup'}\n\n:::\n\n\n\n# Writing a function that removes outliers in a dataset based on a user-defined SD threshold.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nremove_outliers <- function(df, ..., sd_thresh = 3){\n  \n  #check for non-numeric columns\n  non_num <- df %>%\n    select(...) %>%\n    map_lgl(~ !(is.numeric(.x))) %>%\n    keep(identity) %>%\n    names()\n  \n  if (length(non_num) > 0) {\n    stop(\"The following columns are not numeric: \",\n         str_c(non_num, collapse = \", \"))\n  }\n  \n  #finding z-scores of each column\n  z_scores <- df %>% \n    select(...) %>% \n    mutate(across(everything(), scale),\n           id = as.character(c(1:nrow(df)))) %>%\n    filter(if_all(everything(), ~ .< sd_thresh),\n           if_all(everything(), ~ .> sd_thresh * -1))\n  \n  #removing outliers by row ID\n  no_outliers <- df %>%\n    filter(row_number() %in% as.numeric(z_scores$id))\n  \n  #final output\n  no_outliers\n\n}\n```\n:::\n\n\n\n# Writing a function that imputes missing numeric values in a dataset with a default value defined by the user. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimpute_missing <- function(df, ..., impute_fun = mean){\n  \n  #check for non-numeric columns\n  non_num <- df %>%\n    select(...) %>%\n    map_lgl(~ !(is.numeric(.x))) %>%\n    keep(identity) %>%\n    names()\n  \n  if (length(non_num) > 0) {\n    stop(\"The following columns are not numeric: \",\n         str_c(non_num, collapse = \", \"))\n  }\n  \n  #nested function for finding NAs and replacing with user-defined function\n  find_replace <- function(col, nested_fun = impute_fun){\n    col_omit <- na.omit(col)\n    col_fxn <- nested_fun(col_omit)\n    col_replace <- replace_na(col, col_fxn)\n    col_replace\n  }\n  \n  #applying the function to the user-defined columns\n  impute_df <- df %>%\n    select(...) %>%\n    mutate(across(everything(), find_replace)) \n  \n  #placing imputed columns back into main df\n  merged_df <- df\n  merged_df[,colnames(impute_df)] <- impute_df\n  \n  #final output\n  merged_df\n  \n}\n```\n:::\n\n\n\n# Combining the functions defined above into one function that fits a linear regression model for the supplied dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_model <- function(df, impute_missing = F, remove_outliers = F, \n                      mod_formula, ...) {\n  if (impute_missing == T) {\n    df <- impute_missing(df, ...)\n  }\n  \n  if (remove_outliers == T) {\n    df <- remove_outliers(df, ...)\n  }\n  \n  summary(lm(mod_formula, data = df))\n}\n```\n:::\n\n\n\n# Creating a data frame of argument combinations with `crossing()` and iterating over every combination with `pmap()` from the `purrr` package to generate multiple regression models. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_arg_analyses <- crossing(\n  impute = c(TRUE, FALSE),\n  remove_outliers = c(TRUE, FALSE), \n  mod = c(price ~ carat, \n          price ~ carat + cut,\n          price ~ carat + cut + clarity,\n          price ~ carat + cut + clarity + color)\n)\ndf_arg_analyses\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 16 Ã— 3\n   impute remove_outliers mod      \n   <lgl>  <lgl>           <list>   \n 1 FALSE  FALSE           <formula>\n 2 FALSE  FALSE           <formula>\n 3 FALSE  FALSE           <formula>\n 4 FALSE  FALSE           <formula>\n 5 FALSE  TRUE            <formula>\n 6 FALSE  TRUE            <formula>\n 7 FALSE  TRUE            <formula>\n 8 FALSE  TRUE            <formula>\n 9 TRUE   FALSE           <formula>\n10 TRUE   FALSE           <formula>\n11 TRUE   FALSE           <formula>\n12 TRUE   FALSE           <formula>\n13 TRUE   TRUE            <formula>\n14 TRUE   TRUE            <formula>\n15 TRUE   TRUE            <formula>\n16 TRUE   TRUE            <formula>\n```\n\n\n:::\n\n```{.r .cell-code}\ncolnames(df_arg_analyses) <- c(\"impute_missing\", \n                               \"remove_outliers\", \n                               \"mod_formula\")\npmap(df_arg_analyses, fit_model, df = diamonds)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18585.3   -804.8    -18.9    537.4  12731.7 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2256.36      13.06  -172.8   <2e-16 ***\ncarat        7756.43      14.07   551.4   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1549 on 53938 degrees of freedom\nMultiple R-squared:  0.8493,\tAdjusted R-squared:  0.8493 \nF-statistic: 3.041e+05 on 1 and 53938 DF,  p-value: < 2.2e-16\n\n\n[[2]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-17540.7   -791.6    -37.6    522.1  12721.4 \n\nCoefficients:\n            Estimate Std. Error  t value Pr(>|t|)    \n(Intercept) -2701.38      15.43 -175.061  < 2e-16 ***\ncarat        7871.08      13.98  563.040  < 2e-16 ***\ncut.L        1239.80      26.10   47.502  < 2e-16 ***\ncut.Q        -528.60      23.13  -22.851  < 2e-16 ***\ncut.C         367.91      20.21   18.201  < 2e-16 ***\ncut^4          74.59      16.24    4.593 4.37e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1511 on 53934 degrees of freedom\nMultiple R-squared:  0.8565,\tAdjusted R-squared:  0.8565 \nF-statistic: 6.437e+04 on 5 and 53934 DF,  p-value: < 2.2e-16\n\n\n[[3]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-16842.5   -636.4   -114.3    474.8  11238.6 \n\nCoefficients:\n             Estimate Std. Error  t value Pr(>|t|)    \n(Intercept) -3187.540     14.475 -220.208   <2e-16 ***\ncarat        8472.026     12.615  671.584   <2e-16 ***\ncut.L         713.804     22.511   31.709   <2e-16 ***\ncut.Q        -334.503     19.828  -16.871   <2e-16 ***\ncut.C         188.482     17.218   10.947   <2e-16 ***\ncut^4           1.663     13.794    0.121   0.9040    \nclarity.L    4011.681     33.931  118.231   <2e-16 ***\nclarity.Q   -1821.922     31.870  -57.167   <2e-16 ***\nclarity.C     917.658     27.313   33.598   <2e-16 ***\nclarity^4    -430.047     21.831  -19.699   <2e-16 ***\nclarity^5     257.141     17.821   14.429   <2e-16 ***\nclarity^6      26.909     15.539    1.732   0.0833 .  \nclarity^7     186.742     13.685   13.646   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1281 on 53927 degrees of freedom\nMultiple R-squared:  0.8969,\tAdjusted R-squared:  0.8969 \nF-statistic: 3.911e+04 on 12 and 53927 DF,  p-value: < 2.2e-16\n\n\n[[4]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-16813.5   -680.4   -197.6    466.4  10394.9 \n\nCoefficients:\n             Estimate Std. Error  t value Pr(>|t|)    \n(Intercept) -3710.603     13.980 -265.414  < 2e-16 ***\ncarat        8886.129     12.034  738.437  < 2e-16 ***\ncut.L         698.907     20.335   34.369  < 2e-16 ***\ncut.Q        -327.686     17.911  -18.295  < 2e-16 ***\ncut.C         180.565     15.557   11.607  < 2e-16 ***\ncut^4          -1.207     12.458   -0.097    0.923    \nclarity.L    4217.535     30.831  136.794  < 2e-16 ***\nclarity.Q   -1832.406     28.827  -63.565  < 2e-16 ***\nclarity.C     923.273     24.679   37.411  < 2e-16 ***\nclarity^4    -361.995     19.739  -18.339  < 2e-16 ***\nclarity^5     216.616     16.109   13.447  < 2e-16 ***\nclarity^6       2.105     14.037    0.150    0.881    \nclarity^7     110.340     12.383    8.910  < 2e-16 ***\ncolor.L     -1910.288     17.712 -107.853  < 2e-16 ***\ncolor.Q      -627.954     16.121  -38.952  < 2e-16 ***\ncolor.C      -171.960     15.070  -11.410  < 2e-16 ***\ncolor^4        21.678     13.840    1.566    0.117    \ncolor^5       -85.943     13.076   -6.572 5.00e-11 ***\ncolor^6       -49.986     11.889   -4.205 2.62e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1157 on 53921 degrees of freedom\nMultiple R-squared:  0.9159,\tAdjusted R-squared:  0.9159 \nF-statistic: 3.264e+04 on 18 and 53921 DF,  p-value: < 2.2e-16\n\n\n[[5]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19548.0  -1169.4   -124.1    716.9  12326.3 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -1996.95      32.86  -60.77   <2e-16 ***\ncarat        7896.79      26.53  297.69   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2106 on 22220 degrees of freedom\nMultiple R-squared:  0.7995,\tAdjusted R-squared:  0.7995 \nF-statistic: 8.862e+04 on 1 and 22220 DF,  p-value: < 2.2e-16\n\n\n[[6]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-17890.3  -1188.2   -151.4    771.9  12292.5 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2590.29      37.35 -69.351   <2e-16 ***\ncarat        8016.70      26.39 303.749   <2e-16 ***\ncut.L        1661.97      56.23  29.556   <2e-16 ***\ncut.Q        -825.12      49.75 -16.586   <2e-16 ***\ncut.C         579.18      43.26  13.388   <2e-16 ***\ncut^4          85.55      34.19   2.502   0.0124 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2060 on 22216 degrees of freedom\nMultiple R-squared:  0.8082,\tAdjusted R-squared:  0.8081 \nF-statistic: 1.872e+04 on 5 and 22216 DF,  p-value: < 2.2e-16\n\n\n[[7]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-15684.7   -975.1    -97.5    754.6   9335.7 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -3185.64      34.80 -91.533   <2e-16 ***\ncarat        8723.68      22.86 381.626   <2e-16 ***\ncut.L         940.47      46.88  20.062   <2e-16 ***\ncut.Q        -425.26      41.24 -10.312   <2e-16 ***\ncut.C         319.12      35.61   8.960   <2e-16 ***\ncut^4          23.40      28.09   0.833    0.405    \nclarity.L    6723.96      78.34  85.827   <2e-16 ***\nclarity.Q   -2185.28      74.08 -29.499   <2e-16 ***\nclarity.C    1778.65      63.57  27.980   <2e-16 ***\nclarity^4    -827.00      51.59 -16.031   <2e-16 ***\nclarity^5     554.07      41.84  13.244   <2e-16 ***\nclarity^6      40.42      34.72   1.164    0.244    \nclarity^7     323.78      28.26  11.459   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1689 on 22209 degrees of freedom\nMultiple R-squared:  0.8711,\tAdjusted R-squared:  0.871 \nF-statistic: 1.25e+04 on 12 and 22209 DF,  p-value: < 2.2e-16\n\n\n[[8]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-15533.0   -844.8   -216.3    655.4   8241.1 \n\nCoefficients:\n             Estimate Std. Error  t value Pr(>|t|)    \n(Intercept) -4116.384     31.042 -132.607  < 2e-16 ***\ncarat        9383.805     20.523  457.243  < 2e-16 ***\ncut.L         987.938     39.482   25.023  < 2e-16 ***\ncut.Q        -407.735     34.732  -11.739  < 2e-16 ***\ncut.C         326.332     30.004   10.876  < 2e-16 ***\ncut^4           8.035     23.648    0.340   0.7340    \nclarity.L    6974.045     66.208  105.335  < 2e-16 ***\nclarity.Q   -2359.678     62.392  -37.820  < 2e-16 ***\nclarity.C    1778.909     53.599   33.189  < 2e-16 ***\nclarity^4    -705.668     43.480  -16.230  < 2e-16 ***\nclarity^5     516.027     35.277   14.628  < 2e-16 ***\nclarity^6     -13.279     29.237   -0.454   0.6497    \nclarity^7     192.602     23.833    8.081 6.73e-16 ***\ncolor.L     -3027.357     33.038  -91.632  < 2e-16 ***\ncolor.Q      -915.725     29.687  -30.846  < 2e-16 ***\ncolor.C      -169.562     28.035   -6.048 1.49e-09 ***\ncolor^4       -33.016     25.927   -1.273   0.2029    \ncolor^5      -169.411     24.585   -6.891 5.69e-12 ***\ncolor^6       -39.508     22.351   -1.768   0.0771 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1422 on 22203 degrees of freedom\nMultiple R-squared:  0.9087,\tAdjusted R-squared:  0.9086 \nF-statistic: 1.227e+04 on 18 and 22203 DF,  p-value: < 2.2e-16\n\n\n[[9]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18585.3   -804.8    -18.9    537.4  12731.7 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2256.36      13.06  -172.8   <2e-16 ***\ncarat        7756.43      14.07   551.4   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1549 on 53938 degrees of freedom\nMultiple R-squared:  0.8493,\tAdjusted R-squared:  0.8493 \nF-statistic: 3.041e+05 on 1 and 53938 DF,  p-value: < 2.2e-16\n\n\n[[10]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-17540.7   -791.6    -37.6    522.1  12721.4 \n\nCoefficients:\n            Estimate Std. Error  t value Pr(>|t|)    \n(Intercept) -2701.38      15.43 -175.061  < 2e-16 ***\ncarat        7871.08      13.98  563.040  < 2e-16 ***\ncut.L        1239.80      26.10   47.502  < 2e-16 ***\ncut.Q        -528.60      23.13  -22.851  < 2e-16 ***\ncut.C         367.91      20.21   18.201  < 2e-16 ***\ncut^4          74.59      16.24    4.593 4.37e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1511 on 53934 degrees of freedom\nMultiple R-squared:  0.8565,\tAdjusted R-squared:  0.8565 \nF-statistic: 6.437e+04 on 5 and 53934 DF,  p-value: < 2.2e-16\n\n\n[[11]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-16842.5   -636.4   -114.3    474.8  11238.6 \n\nCoefficients:\n             Estimate Std. Error  t value Pr(>|t|)    \n(Intercept) -3187.540     14.475 -220.208   <2e-16 ***\ncarat        8472.026     12.615  671.584   <2e-16 ***\ncut.L         713.804     22.511   31.709   <2e-16 ***\ncut.Q        -334.503     19.828  -16.871   <2e-16 ***\ncut.C         188.482     17.218   10.947   <2e-16 ***\ncut^4           1.663     13.794    0.121   0.9040    \nclarity.L    4011.681     33.931  118.231   <2e-16 ***\nclarity.Q   -1821.922     31.870  -57.167   <2e-16 ***\nclarity.C     917.658     27.313   33.598   <2e-16 ***\nclarity^4    -430.047     21.831  -19.699   <2e-16 ***\nclarity^5     257.141     17.821   14.429   <2e-16 ***\nclarity^6      26.909     15.539    1.732   0.0833 .  \nclarity^7     186.742     13.685   13.646   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1281 on 53927 degrees of freedom\nMultiple R-squared:  0.8969,\tAdjusted R-squared:  0.8969 \nF-statistic: 3.911e+04 on 12 and 53927 DF,  p-value: < 2.2e-16\n\n\n[[12]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-16813.5   -680.4   -197.6    466.4  10394.9 \n\nCoefficients:\n             Estimate Std. Error  t value Pr(>|t|)    \n(Intercept) -3710.603     13.980 -265.414  < 2e-16 ***\ncarat        8886.129     12.034  738.437  < 2e-16 ***\ncut.L         698.907     20.335   34.369  < 2e-16 ***\ncut.Q        -327.686     17.911  -18.295  < 2e-16 ***\ncut.C         180.565     15.557   11.607  < 2e-16 ***\ncut^4          -1.207     12.458   -0.097    0.923    \nclarity.L    4217.535     30.831  136.794  < 2e-16 ***\nclarity.Q   -1832.406     28.827  -63.565  < 2e-16 ***\nclarity.C     923.273     24.679   37.411  < 2e-16 ***\nclarity^4    -361.995     19.739  -18.339  < 2e-16 ***\nclarity^5     216.616     16.109   13.447  < 2e-16 ***\nclarity^6       2.105     14.037    0.150    0.881    \nclarity^7     110.340     12.383    8.910  < 2e-16 ***\ncolor.L     -1910.288     17.712 -107.853  < 2e-16 ***\ncolor.Q      -627.954     16.121  -38.952  < 2e-16 ***\ncolor.C      -171.960     15.070  -11.410  < 2e-16 ***\ncolor^4        21.678     13.840    1.566    0.117    \ncolor^5       -85.943     13.076   -6.572 5.00e-11 ***\ncolor^6       -49.986     11.889   -4.205 2.62e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1157 on 53921 degrees of freedom\nMultiple R-squared:  0.9159,\tAdjusted R-squared:  0.9159 \nF-statistic: 3.264e+04 on 18 and 53921 DF,  p-value: < 2.2e-16\n\n\n[[13]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19548.0  -1169.4   -124.1    716.9  12326.3 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -1996.95      32.86  -60.77   <2e-16 ***\ncarat        7896.79      26.53  297.69   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2106 on 22220 degrees of freedom\nMultiple R-squared:  0.7995,\tAdjusted R-squared:  0.7995 \nF-statistic: 8.862e+04 on 1 and 22220 DF,  p-value: < 2.2e-16\n\n\n[[14]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-17890.3  -1188.2   -151.4    771.9  12292.5 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2590.29      37.35 -69.351   <2e-16 ***\ncarat        8016.70      26.39 303.749   <2e-16 ***\ncut.L        1661.97      56.23  29.556   <2e-16 ***\ncut.Q        -825.12      49.75 -16.586   <2e-16 ***\ncut.C         579.18      43.26  13.388   <2e-16 ***\ncut^4          85.55      34.19   2.502   0.0124 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2060 on 22216 degrees of freedom\nMultiple R-squared:  0.8082,\tAdjusted R-squared:  0.8081 \nF-statistic: 1.872e+04 on 5 and 22216 DF,  p-value: < 2.2e-16\n\n\n[[15]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-15684.7   -975.1    -97.5    754.6   9335.7 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -3185.64      34.80 -91.533   <2e-16 ***\ncarat        8723.68      22.86 381.626   <2e-16 ***\ncut.L         940.47      46.88  20.062   <2e-16 ***\ncut.Q        -425.26      41.24 -10.312   <2e-16 ***\ncut.C         319.12      35.61   8.960   <2e-16 ***\ncut^4          23.40      28.09   0.833    0.405    \nclarity.L    6723.96      78.34  85.827   <2e-16 ***\nclarity.Q   -2185.28      74.08 -29.499   <2e-16 ***\nclarity.C    1778.65      63.57  27.980   <2e-16 ***\nclarity^4    -827.00      51.59 -16.031   <2e-16 ***\nclarity^5     554.07      41.84  13.244   <2e-16 ***\nclarity^6      40.42      34.72   1.164    0.244    \nclarity^7     323.78      28.26  11.459   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1689 on 22209 degrees of freedom\nMultiple R-squared:  0.8711,\tAdjusted R-squared:  0.871 \nF-statistic: 1.25e+04 on 12 and 22209 DF,  p-value: < 2.2e-16\n\n\n[[16]]\n\nCall:\nlm(formula = mod_formula, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-15533.0   -844.8   -216.3    655.4   8241.1 \n\nCoefficients:\n             Estimate Std. Error  t value Pr(>|t|)    \n(Intercept) -4116.384     31.042 -132.607  < 2e-16 ***\ncarat        9383.805     20.523  457.243  < 2e-16 ***\ncut.L         987.938     39.482   25.023  < 2e-16 ***\ncut.Q        -407.735     34.732  -11.739  < 2e-16 ***\ncut.C         326.332     30.004   10.876  < 2e-16 ***\ncut^4           8.035     23.648    0.340   0.7340    \nclarity.L    6974.045     66.208  105.335  < 2e-16 ***\nclarity.Q   -2359.678     62.392  -37.820  < 2e-16 ***\nclarity.C    1778.909     53.599   33.189  < 2e-16 ***\nclarity^4    -705.668     43.480  -16.230  < 2e-16 ***\nclarity^5     516.027     35.277   14.628  < 2e-16 ***\nclarity^6     -13.279     29.237   -0.454   0.6497    \nclarity^7     192.602     23.833    8.081 6.73e-16 ***\ncolor.L     -3027.357     33.038  -91.632  < 2e-16 ***\ncolor.Q      -915.725     29.687  -30.846  < 2e-16 ***\ncolor.C      -169.562     28.035   -6.048 1.49e-09 ***\ncolor^4       -33.016     25.927   -1.273   0.2029    \ncolor^5      -169.411     24.585   -6.891 5.69e-12 ***\ncolor^6       -39.508     22.351   -1.768   0.0771 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1422 on 22203 degrees of freedom\nMultiple R-squared:  0.9087,\tAdjusted R-squared:  0.9086 \nF-statistic: 1.227e+04 on 18 and 22203 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}